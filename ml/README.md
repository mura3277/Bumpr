# ML
The main use for machine learning in Car4Sale is to detect the presence of a car in the user uploaded image. This is to ensure that they are uploading cars (and not nefarious or other unwanted images - i.e. for some form of quality control). The model is currently a pre-trained YOLO (You only look once) model, https://arxiv.org/pdf/1506.02640.pdf, trained on the coco object detection dataset. The dataset I use to verify and evaluate this model is the car object detection dataset on kaggle - see below, which is a compilation of images from a video of cars moving on a road. In production, this model will be used to quickly determine the confidence that a car is present in the image and how much of the image is the car (we can check the area of the bounding box as a percentage of the area of the whole image and determine an appropriate % threshold number).

## Application Specifications
Preliminarily, the car object detection will work on a rudementary opencv yolo architecture. So the necessary python modules (and versions used ) are as follows:
*   kaggle
*   opencv-python
*   not required, but useful: matplotlib

## Dataset
We used the Kaggle Car Object detection dataset, which consists of a variety of car models and positions in the image (all of size 676x380 - our inputs may not be of this size, but in production I will write code to manipulate the input to be of the desired input size). As said above, the images themselves are snippets from a video - going from one image to the next and so forth produces an almost flipbook/post-it note animation like effect.

## Running
After installing the required dependencies, you can retrieve the dataset and pre-trained model by running python fetchData.py, which will aggregate the desired data into their respective folders. But it will also require you to create a kaggle account and create an api key associated with the account. One can then either run the predict or evaluate python files. More details on them below.

### Evaluation
The evaluate.py file shows the model working in action. It will load in the model and the data, from the folders generated by running fetchData.py, and then either run the model on a random given image or evaluated on all images of the training/test data, both of which can either be displayed or saved as image with the detection prediction super-imposed on top of the original image.

### Prediction
Prediction works much like the evaluation, but we want to run it on a particular car image. In which case, we run predict.py pathToImage, which will effectively run a slightly modified version of evaluateImage from evaluate.py on this particular image. This is essentially what the actual use case for this model will be in production (but we likely won't have a need to save the image there but rather, as established previously just care about what percentage of the image the car is and likelihood of its presence).


## In Action
The below shows the model in action through a gif of the model's predictions over a series of segmented videos (images) as input.
![gif not loading](example.gif)

Additional Examples:

![input1 not loading](input1.jpg)
![output1 not loading](output1.jpg)
![input1 not loading](input2.jpg)
![output1 not loading](output2.jpg)
![input1 not loading](input3.jpg)
![output1 not loading](output3.jpg)
